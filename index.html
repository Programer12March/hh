<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hannah's Universe üíñ</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@400;700&family=Nunito:wght@300;400;600;800&family=Pacifico&display=swap" rel="stylesheet">
    
    <meta property="og:title" content="For Hannah üíñ">
    <meta property="og:description" content="A digital universe created just for you.">
    
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üê±</text></svg>">

    <style>
        /* =========================================
           1. VARIABLES & THEME SETUP
           ========================================= */
        :root {
            --primary-hue: 340; /* Pinkish Red */
            --bg-light: #fff0f5;
            --bg-dark: #2d1b21;
            --glass-white: rgba(255, 255, 255, 0.7);
            --glass-border: rgba(255, 255, 255, 0.4);
            --text-main: #5c3a45;
            --text-highlight: #d6336c;
            --accent: #ff8787;
            --shadow-soft: 0 10px 40px rgba(214, 51, 108, 0.15);
            --shadow-deep: 0 15px 35px rgba(0,0,0,0.1);
            --font-heading: 'Pacifico', cursive;
            --font-body: 'Nunito', sans-serif;
            --transition-speed: 0.4s;
        }

        /* Dark Mode Variables */
        body.dark-mode {
            --bg-light: #1a1014;
            --glass-white: rgba(30, 30, 30, 0.6);
            --glass-border: rgba(255, 255, 255, 0.1);
            --text-main: #ffdeeb;
            --text-highlight: #ff8787;
            --shadow-soft: 0 10px 40px rgba(0, 0, 0, 0.5);
            background-color: var(--bg-dark);
            color: var(--text-main);
        }

        /* =========================================
           2. GLOBAL RESET & BASE STYLES
           ========================================= */
        * { box-sizing: border-box; margin: 0; padding: 0; }
        body {
            font-family: var(--font-body);
            background-color: var(--bg-light);
            color: var(--text-main);
            overflow-x: hidden;
            transition: background-color var(--transition-speed), color var(--transition-speed);
        }

        /* Scrollbar beautification */
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: transparent; }
        ::-webkit-scrollbar-thumb { background: var(--accent); border-radius: 10px; }

        /* The Canvas Background */
        #world {
            position: fixed;
            top: 0; left: 0;
            width: 100vw; height: 100vh;
            z-index: -1;
            pointer-events: none;
        }

        /* =========================================
           3. NAVIGATION (GLASSMORPHISM)
           ========================================= */
        .glass-nav {
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            width: 90%;
            max-width: 800px;
            background: var(--glass-white);
            backdrop-filter: blur(16px);
            -webkit-backdrop-filter: blur(16px);
            border: 1px solid var(--glass-border);
            border-radius: 50px;
            padding: 15px 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: var(--shadow-soft);
            z-index: 100;
        }

        .logo { font-family: var(--font-heading); font-size: 1.5rem; color: var(--text-highlight); }
        .nav-links { list-style: none; display: flex; gap: 20px; }
        .nav-links li { cursor: pointer; transition: color 0.3s; font-weight: 600; }
        .nav-links li:hover, .nav-links li.active { color: var(--text-highlight); }
        .nav-links li.active { position: relative; }
        .nav-links li.active::after {
            content: ''; position: absolute; bottom: -5px; left: 0; width: 100%; height: 3px;
            background: var(--text-highlight); border-radius: 2px;
        }
        .theme-toggle { background: none; border: none; font-size: 1.2rem; cursor: pointer; }

        /* Mobile Nav Handling */
        @media (max-width: 768px) {
            .nav-links { display: none; }
            .glass-nav { justify-content: center; }
        }

        /* =========================================
           4. SPA VIEWS & TRANSITIONS
           ========================================= */
        main { padding-top: 100px; min-height: 100vh; }
        .view {
            display: none;
            opacity: 0;
            transform: translateY(20px);
            transition: opacity 0.5s ease, transform 0.5s ease;
            padding: 20px;
            max-width: 1200px;
            margin: 0 auto;
        }
        .view.active-view {
            display: block;
            opacity: 1;
            transform: translateY(0);
        }

        /* =========================================
           5. HERO SECTION STYLES
           ========================================= */
        .hero-content {
            text-align: center;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 80vh;
        }
        .hero-cat-svg {
            width: 300px;
            height: 300px;
            filter: drop-shadow(0 10px 10px rgba(0,0,0,0.1));
        }
        .title-anim { font-family: var(--font-heading); font-size: 4rem; color: var(--text-highlight); margin: 20px 0; }
        .subtitle-anim { font-size: 1.2rem; max-width: 600px; margin-bottom: 30px; }

        .cta-btn {
            padding: 15px 40px;
            font-size: 1.2rem;
            background: linear-gradient(45deg, #ff9a9e 0%, #fad0c4 99%, #fad0c4 100%);
            border: none;
            border-radius: 50px;
            color: white;
            font-weight: bold;
            cursor: pointer;
            box-shadow: 0 10px 20px rgba(255, 154, 158, 0.4);
            transition: transform 0.2s;
        }
        .cta-btn:hover { transform: scale(1.05); }

        @keyframes float { 0% { transform: translateY(0px); } 50% { transform: translateY(-15px); } 100% { transform: translateY(0px); } }
        .floating-cat-hero { animation: float 4s ease-in-out infinite; }
        @keyframes beat { 0%, 100% { transform: scale(1); } 50% { transform: scale(1.1); } }
        .beating-heart { transform-origin: center; animation: beat 1.5s infinite; }

        /* =========================================
           6. MEMORIES (TIMELINE)
           ========================================= */
        .timeline-container {
            position: relative;
            max-width: 800px;
            margin: 50px auto;
            padding: 20px 0;
        }
        .timeline-container::after {
            content: '';
            position: absolute;
            width: 4px;
            background-color: var(--accent);
            top: 0; bottom: 0; left: 50%;
            margin-left: -2px;
            border-radius: 2px;
        }
        .timeline-item {
            padding: 10px 40px;
            position: relative;
            background-color: inherit;
            width: 50%;
        }
        .timeline-item.left { left: 0; }
        .timeline-item.right { left: 50%; }

        .timeline-item::after {
            content: 'üêæ';
            position: absolute;
            width: 30px; height: 30px;
            right: -15px; background-color: white;
            border: 4px solid var(--accent);
            top: 15px; border-radius: 50%; z-index: 1;
            display: flex; align-items: center; justify-content: center; font-size: 12px;
        }
        .right::after { left: -15px; }

        .timeline-item .content {
            padding: 20px 30px;
            background: var(--glass-white);
            border-radius: 15px;
            box-shadow: var(--shadow-soft);
            border: 1px solid var(--glass-border);
        }

        /* --- THIS IS THE NEW CODE FOR YOUR IMAGES --- */
        .memory-img {
            width: 100%;           /* Forces image to fit the container width */
            height: 200px;         /* Sets a fixed height so all images look even */
            object-fit: cover;     /* Crops the image so it doesn't look squashed/stretched */
            border-radius: 10px;   /* Rounds the corners */
            display: block;
            margin: 10px 0;
        }

        /* =========================================
           7. REASONS GRID
           ========================================= */
        .grid-container {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 20px;
            padding: 20px;
        }
        .reason-card {
            background: var(--glass-white);
            padding: 20px;
            border-radius: 15px;
            text-align: center;
            border: 1px solid var(--glass-border);
            transition: transform 0.3s;
        }
        .reason-card:hover { transform: translateY(-5px); }
        .icon-box { font-size: 2rem; margin-bottom: 10px; }
        .reason-title { color: var(--text-highlight); margin-bottom: 5px; }

        /* =========================================
           8. INTERACTIVE ELEMENTS
           ========================================= */
        #loader {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: #fff0f5; z-index: 9999;
            display: flex; align-items: center; justify-content: center;
            transition: opacity 1s;
        }
        .loader-content { text-align: center; }
        .heart-loader { width: 50px; animation: beat 0.8s infinite; }

        #music-player {
            position: fixed; bottom: 20px; right: 20px;
            background: var(--glass-white);
            backdrop-filter: blur(10px);
            padding: 15px;
            border-radius: 20px;
            box-shadow: var(--shadow-deep);
            display: flex; gap: 15px; align-items: center;
            border: 1px solid var(--glass-border); z-index: 500;
        }
        .disc {
            width: 40px; height: 40px; background: #333; border-radius: 50%;
            animation: spin 3s linear infinite; animation-play-state: paused;
            position: relative;
        }
        .disc-center {
            width: 10px; height: 10px; background: #fff; border-radius: 50%;
            position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);
        }
        .disc.playing { animation-play-state: running; }
        @keyframes spin { 100% { transform: rotate(360deg); } }

        button#btn-play {
            background: none; border: none; font-size: 1.5rem; cursor: pointer; color: var(--text-highlight);
        }

        /* =========================================
           9. GAME STYLES
           ========================================= */
        .game-ui { text-align: center; }
        .game-area {
            width: 100%; max-width: 600px; height: 400px; margin: 20px auto;
            position: relative; border: 2px solid var(--accent); border-radius: 10px;
            overflow: hidden; background: rgba(255,255,255,0.5);
        }
        #game-overlay {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.5); display: flex; align-items: center; justify-content: center;
        }
        #start-game-btn {
            padding: 15px 30px; font-size: 1.2rem; background: var(--accent); border: none;
            color: white; border-radius: 30px; cursor: pointer;
        }

        /* =========================================
           10. LETTER ENVELOPE
           ========================================= */
        .envelope-container { perspective: 1000px; display: flex; justify-content: center; flex-direction: column; align-items: center; margin-top: 50px; }
        .envelope {
            width: 300px; height: 200px; background: #ff6b81; position: relative;
            transform-style: preserve-3d; transition: transform 0.6s;
            cursor: pointer; margin-bottom: 20px;
            display: flex; align-items: center; justify-content: center;
            color: white; font-weight: bold;
        }
        .letter-content {
            background: #fff; width: 80%; max-width: 600px; min-height: 400px;
            padding: 40px; border-radius: 5px; box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            font-family: 'Dancing Script', cursive; font-size: 1.5rem; line-height: 1.6;
            display: none; /* Hidden until unlocked */
            background-image: linear-gradient(#eee .1rem, transparent .1rem);
            background-size: 100% 2rem;
            margin: 0 auto;
        }
        .lock-message {
            background: #333; color: #fff; padding: 10px 20px; border-radius: 20px; margin-top: 20px;
        }
    </style>
</head>
<body>

    <div id="loader">
        <div class="loader-content">
            <svg class="heart-loader" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z" fill="#ffacc7"/>
            </svg>
            <p>Loading Hannah's Universe...</p>
        </div>
    </div>

    <div id="music-player">
        <div class="disc-wrapper">
            <div class="disc">
                <div class="disc-center"></div>
            </div>
        </div>
        <div class="player-controls">
            <button id="btn-play">‚ñ∂ Music</button>
        </div>
        <audio id="audio-source" loop>
            <source src="bg-music.mp3" type="audio/mpeg">
        </audio>
    </div>

    <canvas id="world"></canvas>

    <nav class="glass-nav">
        <div class="logo">H &hearts;</div>
        <ul class="nav-links">
            <li data-target="home" class="active">Home</li>
            <li data-target="memories">Memories</li>
            <li data-target="reasons">Why You?</li>
            <li data-target="game">Surprise Game</li>
            <li data-target="letter">Love Letter</li>
        </ul>
        <button class="theme-toggle">üåô</button>
    </nav>

    <main id="app">

        <section id="home" class="view active-view">
            <div class="hero-content">
                <div class="floating-cat-hero">
                    <svg viewBox="0 0 500 500" class="hero-cat-svg">
                        <defs>
                            <filter id="glow" x="-20%" y="-20%" width="140%" height="140%">
                                <feGaussianBlur stdDeviation="10" result="blur"/>
                                <feComposite in="SourceGraphic" in2="blur" operator="over"/>
                            </filter>
                        </defs>
                        <circle cx="250" cy="270" r="150" fill="#fff" filter="url(#glow)" opacity="0.6"/>
                        <g class="cat-body">
                            <path d="M180 150 L150 50 L250 120 Z" fill="#6e4a55"/>
                            <path d="M320 150 L350 50 L250 120 Z" fill="#6e4a55"/>
                            <ellipse cx="250" cy="200" rx="120" ry="100" fill="#fff0f3" stroke="#6e4a55" stroke-width="5"/>
                            <ellipse class="eye blink" cx="210" cy="180" rx="15" ry="20" fill="#333"/>
                            <ellipse class="eye blink" cx="290" cy="180" rx="15" ry="20" fill="#333"/>
                            <circle cx="180" cy="210" r="15" fill="#ffacc7" opacity="0.6"/>
                            <circle cx="320" cy="210" r="15" fill="#ffacc7" opacity="0.6"/>
                            <path d="M240 210 L260 210 L250 225 Z" fill="#ff6b81"/>
                            <path d="M250 225 Q230 245 210 230" fill="none" stroke="#333" stroke-width="3"/>
                            <path d="M250 225 Q270 245 290 230" fill="none" stroke="#333" stroke-width="3"/>
                        </g>
                        <g class="paws" transform="translate(0, 50)">
                            <ellipse cx="200" cy="300" rx="25" ry="20" fill="#fff" stroke="#6e4a55" stroke-width="3"/>
                            <ellipse cx="300" cy="300" rx="25" ry="20" fill="#fff" stroke="#6e4a55" stroke-width="3"/>
                            <path class="beating-heart" d="M250 280 C220 250 180 300 250 350 C320 300 280 250 250 280" fill="#ff4757"/>
                        </g>
                    </svg>
                </div>
                <h1 class="title-anim">Welcome, Hannah</h1>
                <p class="subtitle-anim">This is your safe space. A world built on code, running on love.</p>
                <button class="cta-btn" onclick="navigateTo('memories')">Explore Our World üêæ</button>
            </div>
        </section>

        <section id="memories" class="view">
            <h2 class="section-header" style="text-align:center;">Timeline of Us <span class="cat-emoji">üê±</span></h2>
            <div class="timeline-container">
                <div class="timeline-item left">
                    <div class="content">
                        <h3>The Beginning</h3>
                        <p>The day the stars aligned.</p>
                        <img src="photo1.png" class="memory-img" alt="First Date">
                        <span class="date">Day 1</span>
                    </div>
                </div>
                <div class="timeline-item right">
                    <div class="content">
                        <h3>First Adventure</h3>
                        <p>Getting lost together was the best part.</p>
                        <img src="photo2.png" class="memory-img" alt="Adventure">
                        <span class="date">Day 45</span>
                    </div>
                </div>
                <div class="timeline-item left">
                    <div class="content">
                        <h3>Just Because</h3>
                        <p>Every small moment adds up to this.</p>
                        <img src="photo3.png" class="memory-img" alt="Small Moment">
                        <span class="date">Today</span>
                    </div>
                </div>
            </div>
        </section>

        <section id="reasons" class="view">
            <h2 class="section-header" style="text-align:center;">100 Reasons (Preview)</h2>
            <div class="grid-container" id="reasons-grid-target"></div>
            <template id="reason-card-template">
                <div class="reason-card">
                    <div class="icon-box"></div>
                    <h4 class="reason-title"></h4>
                    <p class="reason-desc"></p>
                </div>
            </template>
        </section>

        <section id="game" class="view">
            <div class="game-ui">
                <h2>Catch the Hearts! <span id="score">0</span>/10</h2>
                <p>Help the kitty catch enough love to unlock your letter.</p>
                <div class="game-area" id="game-canvas-container">
                    <canvas id="game-canvas"></canvas>
                    <div id="game-overlay">
                        <button id="start-game-btn">Start Game üéÆ</button>
                    </div>
                </div>
            </div>
        </section>

        <section id="letter" class="view">
            <div class="envelope-container">
                <div class="envelope" id="envelope">
                    <div class="front">
                        <div class="stamp">H</div>
                        <div class="address" style="text-align:center">To: Hannah<br>From: Me</div>
                    </div>
                </div>
                <div class="lock-message" id="lock-msg">
                    üîí Complete the Heart Game to open this envelope!
                </div>
                <div class="letter-content">
                    <div class="paper">
                        <p id="typing-text"></p>
                        <div class="signature" style="text-align: right; margin-top: 20px;">- With all my love</div>
                    </div>
                </div>
            </div>
        </section>

    </main>

    <svg style="display: none;">
        <symbol id="icon-cat" viewBox="0 0 24 24">
            <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8 0-.46.04-.92.11-1.36.75 1.27 2.05 2.16 3.56 2.34 1.35.16 2.65-.4 3.54-1.42.89 1.02 2.19 1.58 3.54 1.42 1.51-.18 2.81-1.07 3.56-2.34.07.44.11.9.11 1.36 0 4.41-3.59 8-8 8z" fill="currentColor"/>
        </symbol>
        <symbol id="icon-heart" viewBox="0 0 24 24">
            <path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z" fill="currentColor"/>
        </symbol>
    </svg>

    <script>
        /* =========================================
           STATE MANAGEMENT
           ========================================= */
        const state = {
            view: 'home',
            isDark: false,
            musicPlaying: false,
            gameUnlocked: false,
            score: 0
        };

        /* =========================================
           DOM ELEMENTS
           ========================================= */
        const views = document.querySelectorAll('.view');
        const navLinks = document.querySelectorAll('.nav-links li');
        const loader = document.getElementById('loader');

        /* =========================================
           INIT & NAVIGATION
           ========================================= */
        window.addEventListener('load', () => {
            // Simulate loading time for effect
            setTimeout(() => {
                loader.style.opacity = '0';
                setTimeout(() => { loader.style.display = 'none'; }, 1000);
                generateReasons(); // Build the grid
            }, 1500);
        });

        // Make navigateTo globally accessible
        window.navigateTo = function(targetId) {
            state.view = targetId;
            
            navLinks.forEach(l => l.classList.remove('active'));
            const activeLink = document.querySelector(`[data-target="${targetId}"]`);
            if(activeLink) activeLink.classList.add('active');
            
            views.forEach(v => {
                v.classList.remove('active-view');
                if(v.id === targetId) {
                    v.classList.add('active-view');
                }
            });

            if(targetId === 'game') initGame();
        };

        navLinks.forEach(link => {
            link.addEventListener('click', () => {
                window.navigateTo(link.getAttribute('data-target'));
            });
        });

        /* =========================================
           THEME TOGGLE
           ========================================= */
        const themeBtn = document.querySelector('.theme-toggle');
        themeBtn.addEventListener('click', () => {
            state.isDark = !state.isDark;
            document.body.classList.toggle('dark-mode');
            themeBtn.innerText = state.isDark ? '‚òÄÔ∏è' : 'üåô';
        });

        /* =========================================
           DYNAMIC CONTENT: 100 REASONS
           ========================================= */
        function generateReasons() {
            const container = document.getElementById('reasons-grid-target');
            const template = document.getElementById('reason-card-template');
            
            const adjectives = ["Beautiful", "Kind", "Smart", "Funny", "Sweet", "Loving", "Caring", "Brave"];
            const nouns = ["Smile", "Heart", "Eyes", "Laugh", "Voice", "Soul", "Style", "Hugs"];
            
            for(let i = 1; i <= 20; i++) {
                const clone = template.content.cloneNode(true);
                const adj = adjectives[Math.floor(Math.random() * adjectives.length)];
                const noun = nouns[Math.floor(Math.random() * nouns.length)];
                
                clone.querySelector('.reason-title').innerText = `#${i} ${adj} ${noun}`;
                clone.querySelector('.reason-desc').innerText = "Because you make the world brighter just by being you.";
                clone.querySelector('.icon-box').innerText = ['üíñ','üê±','‚ú®','üßÅ'][Math.floor(Math.random()*4)];
                
                container.appendChild(clone);
            }
        }

        /* =========================================
           AUDIO PLAYER LOGIC
           ========================================= */
        const audio = document.getElementById('audio-source');
        const btnPlay = document.getElementById('btn-play');
        const disc = document.querySelector('.disc');

        btnPlay.addEventListener('click', () => {
            if(state.musicPlaying) {
                audio.pause();
                disc.classList.remove('playing');
                btnPlay.innerText = "‚ñ∂ Music";
            } else {
                audio.play().catch(e => alert("Please interact with the page first!"));
                disc.classList.add('playing');
                btnPlay.innerText = "‚è∏ Pause";
            }
            state.musicPlaying = !state.musicPlaying;
        });

        /* =========================================
           BACKGROUND PHYSICS ENGINE (CANVAS)
           ========================================= */
        const canvas = document.getElementById('world');
        const ctx = canvas.getContext('2d');
        let width, height;
        let particles = [];

        function resize() {
            width = canvas.width = window.innerWidth;
            height = canvas.height = window.innerHeight;
        }
        window.addEventListener('resize', resize);
        resize();

        class Particle {
            constructor() {
                this.x = Math.random() * width;
                this.y = height + Math.random() * 100;
                this.velY = Math.random() * -1 - 0.5;
                this.velX = Math.random() * 2 - 1;
                this.size = Math.random() * 20 + 10;
                this.type = Math.random() > 0.5 ? '‚ù§Ô∏è' : 'üê±';
                this.opacity = Math.random() * 0.5 + 0.1;
            }
            update() {
                this.y += this.velY;
                this.x += this.velX;
                if (this.y < -50) {
                    this.y = height + 50;
                    this.x = Math.random() * width;
                }
            }
            draw() {
                ctx.font = `${this.size}px Arial`;
                ctx.globalAlpha = this.opacity;
                ctx.fillStyle = state.isDark ? '#fff' : '#ffacc7';
                ctx.fillText(this.type, this.x, this.y);
                ctx.globalAlpha = 1;
            }
        }

        function initParticles() {
            for (let i = 0; i < 50; i++) particles.push(new Particle());
        }

        function animateParticles() {
            ctx.clearRect(0, 0, width, height);
            particles.forEach(p => {
                p.update();
                p.draw();
            });
            requestAnimationFrame(animateParticles);
        }
        initParticles();
        animateParticles();

        /* =========================================
           MINI GAME: CATCH THE LOVE
           ========================================= */
        const gameCanvas = document.getElementById('game-canvas');
        const gCtx = gameCanvas.getContext('2d');
        let gameLoopId;
        let gameItems = [];
        let catcher = { x: 150, y: 0, width: 50, height: 50 };

        function initGame() {
            const container = document.getElementById('game-canvas-container');
            gameCanvas.width = container.offsetWidth;
            gameCanvas.height = 400; 
            catcher.y = gameCanvas.height - 60;
            catcher.x = gameCanvas.width / 2;
            
            gameCanvas.addEventListener('mousemove', (e) => {
                const rect = gameCanvas.getBoundingClientRect();
                catcher.x = e.clientX - rect.left - catcher.width/2;
            });
            
            document.getElementById('start-game-btn').onclick = startGameLoop;
        }

        function startGameLoop() {
            document.getElementById('game-overlay').style.display = 'none';
            state.score = 0;
            document.getElementById('score').innerText = '0';
            gameItems = [];
            spawnItem();
            updateGame();
        }

        function spawnItem() {
            gameItems.push({
                x: Math.random() * (gameCanvas.width - 30),
                y: -30,
                speed: Math.random() * 3 + 2,
                type: '‚ù§Ô∏è'
            });
            if(state.score < 10) setTimeout(spawnItem, 1000);
        }

        function updateGame() {
            gCtx.clearRect(0, 0, gameCanvas.width, gameCanvas.height);
            
            gCtx.font = "40px Arial";
            gCtx.fillText("üê±", catcher.x, catcher.y + 40);
            
            for(let i=0; i<gameItems.length; i++) {
                let item = gameItems[i];
                item.y += item.speed;
                
                gCtx.font = "30px Arial";
                gCtx.fillText(item.type, item.x, item.y);
                
                if(item.y > catcher.y && item.y < catcher.y + catcher.height && 
                   item.x > catcher.x && item.x < catcher.x + catcher.width) {
                       state.score++;
                       document.getElementById('score').innerText = state.score;
                       gameItems.splice(i, 1);
                       i--;
                       
                       if(state.score >= 10) winGame();
                } else if (item.y > gameCanvas.height) {
                    gameItems.splice(i, 1);
                    i--;
                    spawnItem(); 
                }
            }
            
            if(state.score < 10) gameLoopId = requestAnimationFrame(updateGame);
        }

        function winGame() {
            cancelAnimationFrame(gameLoopId);
            gCtx.fillStyle = "rgba(255, 255, 255, 0.9)";
            gCtx.fillRect(0,0, gameCanvas.width, gameCanvas.height);
            gCtx.fillStyle = "#d6336c";
            gCtx.font = "30px Arial";
            gCtx.fillText("You Won! Letter Unlocked!", 50, 200);
            
            document.getElementById('lock-msg').style.display = 'none';
            document.getElementById('envelope').style.display = 'none';
            document.querySelector('.letter-content').style.display = 'block';
            
            setTimeout(() => {
                window.navigateTo('letter');
                typeLetter();
            }, 2000);
        }

        /* =========================================
           TYPEWRITER EFFECT FOR LETTER
           ========================================= */
        const letterText = "My Dearest Hannah,\n\nIf you are reading this, you caught all the love I sent your way. I wanted to build something that lasts forever, just like how I feel about you.\n\nYou are my code's missing semicolon‚Äîlife just doesn't run right without you.\n\nLove always,\nYour Kabir üíñ";

        function typeLetter() {
            const el = document.getElementById('typing-text');
            el.innerHTML = "";
            let i = 0;
            const speed = 50; 
            
            function type() {
                if (i < letterText.length) {
                    el.innerHTML += letterText.charAt(i) === '\n' ? '<br>' : letterText.charAt(i);
                    i++;
                    setTimeout(type, speed);
                }
            }
            type();
        }
    </script>
</body>

</html>
